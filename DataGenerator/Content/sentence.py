# pip install markovify
import random
from typing import Tuple

try:
    import markovify
except ImportError:
    markovify = None


_DEFAULT_CORPUS = [
    "项目启动以来，团队成员紧密协作，逐步完善各项关键功能，确保交付质量。",
    "在市场需求不断变化的背景下，敏捷迭代能够帮助我们快速验证假设并调整策略。",
    "用户反馈显示，新版本在易用性上获得显著提升，满意度较上一季度提高了十二个百分点。",
    "为了达成年度目标，需要进一步拓展渠道合作，并持续优化产品结构。",
    "随着智能化技术的融入，数据分析能力将成为企业提升竞争力的重要抓手。",
    "我们将持续关注用户体验，围绕真实场景不断优化交互设计，提升整体服务水平。",
    "面对复杂多变的环境，团队秉持务实精神，以创新驱动发展，在多个领域取得突破。",
    "新的合作计划已经进入实施阶段，双方通过共享资源和联合研发实现了成本与效率的双重优化。",
    "研发团队持续跟进核心算法的表现，针对训练数据做了多轮清洗与扩充，显著改善了模型的泛化能力。",
    "为了更好地服务客户，客服中心引入智能质检系统，对通话文本进行实时分析并输出改进建议。",
    "财务部发布的季度报告显示，公司营收稳定增长，现金流状况良好，为后续扩张提供了坚实基础。",
    "运营团队围绕用户生命周期制定了精细化运营策略，通过多次实验找到了转化率的关键驱动因素。",
    "近期上线的流程自动化平台帮助供应链团队减少了大量重复劳动，订单处理效率提升近三分之一。",
    "在合规管理方面，我们已建立覆盖全业务线的审计机制，确保各项操作符合最新监管要求。",
    "随着国际业务的拓展，跨文化沟通愈发重要，我们正在建设多语言支持体系以满足本地化需求。",
    "教育培训部门推出了系列数字化课程，帮助员工在短时间内掌握新工具并快速应用于日常工作。",
    "市场部与品牌机构合作策划的线上活动效果显著，社交媒体话题曝光量突破历史峰值。",
    "针对生产线的数字化改造计划正在稳步推进，智能设备上线后大幅降低了能耗和物料损耗。",
    "数据安全团队完成了全站加密改造，并部署行为监控系统，及时发现潜在入侵风险。",
    "产品团队通过用户旅程地图梳理关键触点，进一步明确了需要打磨的体验节点。",
    "人力资源部引入了人才画像系统，通过数据分析识别高潜力员工并提供定制化成长路径。",
    "我们与高校合作成立联合实验室，聚焦前沿课题研究并探索技术在实际产业中的落地方案。",
    "客户成功团队建立了季度深度回访机制，聚焦挖掘客户深层次需求并挖掘增值机会。",
    "物流部门上线了全链路追踪系统，对运输过程进行实时监控，显著降低了延误率。",
    "在质量管理上，我们引入了多维度指标体系，实现生产过程透明化与可追溯化。",
    "可持续发展委员会发布年度环境报告，披露碳排放、能源使用与绿色采购情况。",
    "公司举办的创意马拉松活动激发了员工的创新热情，多项创意已进入孵化阶段。",
    "我们积极拓展开放平台生态，与合作伙伴共享接口和数据，提升整体价值链的协同效率。",
    "客户调研结果表明，智能推荐系统在内容匹配度上获得了广泛好评，用户停留时长明显延长。",
    "客服机器人通过持续训练能够处理更多复杂问题，为人工客服释放了宝贵时间。",
    "法务团队在合同模板中新增了多项风险防范条款，确保合作流程更加严谨可控。",
    "在数字营销方面，我们引入了新一代归因模型，用以评估各渠道投放带来的真实贡献。",
    "随着仓储自动化程度提升，库存周转效率显著改善，整体运营成本逐季下降。",
    "项目管理办公室建立了统一的里程碑跟踪系统，帮助各项目及时识别风险并采取措施。",
    "智能终端新版本加强了语音交互能力，用户可通过自然语言完成复杂指令。",
    "我们持续跟进政策动向，积极参与行业协会，推动相关标准制定与优化。",
    "培训平台的微课程模块上线后，学习参与度显著提升，用户平均完成率达到九成以上。",
    "为提升社区氛围，产品新增了话题广场与专家答疑，促进用户之间的交流分享。",
    "技术团队完成了大规模服务迁移，系统架构更加弹性，可应对峰值访问压力。",
    "在国际展会上展示的创新成果引起了广泛关注，洽谈合作的潜在伙伴数量显著增加。",
    "安全响应中心实施了二十四小时监控机制，网络攻击平均响应时间缩短了一半。",
    "供应商管理平台上线后实现了资质自动审核与绩效评分，供应链更加透明高效。",
    "我们将更多资源投入研发，聚焦差异化竞争优势，持续提升产品核心壁垒。",
    "品牌故事营销项目收获了大量自发传播，用户对企业理念的认同感持续增强。",
    "新员工入职流程全面数字化，资料上传与审批全部在线完成，大幅缩短了等待时间。",
    "在智慧城市项目中，我们提供的实时数据平台帮助规划部门做出更精准的决策。",
    "通过搭建设备远程诊断系统，客户能够在第一时间获取运维建议与技术支持。",
    "为加强知识管理，公司建立了跨部门的最佳实践库，鼓励经验沉淀与复用。",
    "我们与公益组织合作开展乡村教育项目，持续提供技术支持与培训资源。",
    "财务共享中心投入运营后，报销流程平均处理时间缩短了三分之二。",
    "客户忠诚计划推出积分与等级体系，促进老客户复购并吸引更多口碑传播。",
    "我们在核心系统中嵌入了过程监控指标，确保关键节点可审计、可追踪。",
    "人工智能实验室开展的图像识别项目在多个测试数据集上取得突破性成绩。",
    "团队引入OKR管理方式，确保目标与结果紧密对齐，每个季度都会复盘与迭代。",
    "风控部门构建了实时预警模型，能在交易异常发生时自动阻断风险。",
    "为了提升员工幸福感，公司升级了福利体系并引入灵活工作安排。",
    "我们为中小企业客户推出了轻量化的云解决方案，帮助他们快速启用数字工具。",
    "新发布的行业白皮书总结了关键趋势，成为各界研究的重要参考资料。",
    "客户案例库持续更新，展示不同规模企业的成功实践，增强潜在客户的信心。",
    "在售后服务环节，我们上线了预约上门与远程诊断并行的服务模式。",
    "本季度的能源管理项目让总部大楼的能耗同比下降了近两成。",
    "我们与创业团队共建加速营，为创新项目提供资金、技术与市场资源支持。",
    "公司内部的创意提案平台每周都有新创意被评审并进入试点阶段。",
    "为推动文化建设，企业定期举办读书会与分享会，营造开放交流的氛围。",
    "行业合作联盟发布的安全指导方案为各成员企业提供了统一的合规指南。",
    "对外公布的社会责任报告展示了我们在环保、公益与员工关怀方面的持续投入。",
    "通过强化数据治理，我们实现了跨系统数据的标准化，支持更可靠的业务分析。",
    "金融科技团队研发的风控引擎已在多条业务线上部署，显著降低了信用逾期率。",
    "为提升跨部门协同效率，我们上线了统一的协同平台与信息看板。",
    "最新的产品路线图已经公开，将在未来一年内逐步实现多项迭代与新功能发布。",
    "行业峰会中发表的主题演讲获得高度评价，进一步提升了企业在行业内的影响力。",
    "通过构建客户体验指数指标，我们对用户旅程进行了量化衡量并制定了改进计划。",
    "制造基地引入的AGV机器人改变了物料配送方式，降低人工成本并提高安全性。",
    "我们持续拓展开放API生态，帮助合作伙伴构建定制化解决方案。",
    "跨境电商团队优化了清关流程，实现了更快的物流通关体验。",
    "在智慧医疗领域，我们的远程会诊平台帮助偏远地区医院获得更多专家支持。",
    "内部黑客松激发了多项前瞻概念验证项目，为未来产品方向提供了灵感。",
    "我们设立了企业创新基金，支持员工将创意转化为实际项目进行孵化。",
    "客户数据平台打通后，各业务线能够实时共享用户画像并开展精准营销。",
    "各区域办事处分布式部署的客服系统实现了统一调度，显著提升响应速度。",
    "在文化传播上，我们制作了纪录短片记录企业发展故事，增强团队自豪感。",
    "公司连续多年获得社会责任大奖，充分体现了我们在公益领域的持续承诺。",
    "面对突发事件应急预案的多轮演练让团队在真实场景中更加从容高效。",
    "我们上线了跨平台的知识问答系统，团队成员可以即时获取解决方案。",
    "新签署的战略合作协议将推动双方在云计算与大数据领域开展深度共创。",
    "培训中心与行业专家联合推出认证课程，帮助学员获得权威资质。",
    "供应链金融业务通过风控模型与区块链技术确保信息真实可靠。",
    "我们持续关注数据隐私政策变化，并及时更新产品以符合最新法规要求。",
    "创新实验室提出的人机协作方案正在制造业客户中试点，初步反馈积极。",
    "为了支持创业生态，我们提供开放沙盒环境供开发者测试和验证新想法。",
    "团队通过绩效回顾会议总结经验教训，形成标准流程并推广到全公司。",
    "在多云部署策略下，我们优化了成本结构，同时保持系统高可用与容错能力。",
    "来自全球用户的案例分享展示了技术在教育、医疗、农业等领域的多样应用。",
    "公司发布的行业深度研究报告被多家媒体引用，显示出研究团队的专业影响力。",
    "通过建立内部导师制度，新员工能够快速融入团队并保持持续成长。",
    "我们持续迭代智能风控产品，确保在复杂场景下依然能够准确识别风险。",
    "城市数字化项目中的数据中枢平台帮助管理者实时掌握关键运行指标。",
    "随着多语言客服团队的建立，国际用户在支持体验上得到了明显提升。",
    "我们邀请行业专家组成顾问委员会，定期提供战略层面的指导意见。",
    "为提升公众透明度，公司定期发布业务进展与数据指标，强化外部信任。",
    "内部社区上线了技能分享模块，鼓励跨团队交流，促进知识快速传播。",
    "我们在核心业务中引入绿色理念，积极探索循环经济和节能减排的实际措施。",
    "产品体验部采用大规模可用性测试，持续捕捉用户痛点并优化交互流程。",
    "客服部门建立的满意度回访流程帮助我们及时识别问题并推进闭环解决。",
    "随着边缘计算节点的部署，我们的物联网解决方案具备更低时延和更高可靠性。",
    "企业大学上线了领导力课程，助力管理者提升组织协同与变革能力。",
    "企业文化月系列活动增强了员工之间的凝聚力，打造了积极向上的工作氛围。",
    "我们将ESG指标纳入经营评估体系，推动业务发展与社会责任同步前进。",
    "行业生态大会上的圆桌论坛促成了多项潜在合作，为未来发展开辟了新路径。",
    "通过统一监控平台，我们对服务性能、业务指标与安全告警实现了集中展示。",
    "智能质检系统能够实时标注语音与文本中的异常，帮助团队针对性提升服务质量。",
    "我们持续丰富产品模块的可配置选项，让客户能够根据业务场景灵活定制。",
    "在产品推广期，我们同步上线多语言内容，满足不同地区用户的信息需求。",
    "跨部门协作小组定期分享项目进展和风险预警，确保信息透明与决策高效。",
    "随着数字支付渠道的拓展，线上交易体验变得更加顺畅且安全可靠。",
    "我们为合作伙伴提供全生命周期支持，从售前咨询到售后运营均有专属团队对接。",
    "通过开放创新大赛，我们吸引了大学生与研发团队共同探索前沿技术的实际应用。",
    "最新发布的年度愿景明确了未来三年的战略路径和关键行动计划。",
    "技术部推出的自助部署工具显著减少了项目交付周期，受到客户广泛好评。",
    "我们将继续深化数据驱动文化，鼓励各业务团队在决策中广泛引用数据洞察。",
    "随着生态伙伴的不断加入，平台服务能力与影响力都获得了显著提升。",
    "客户论坛活动为用户搭建了经验交流平台，形成了有益的行业社区生态。",
    "我们在多个区域设立用户体验中心，邀请客户亲身体验产品并提出改进建议。",
    "通过完善的供应商激励机制，我们与合作伙伴建立了更加稳固的互信关系。"
]


def _build_default_model(state_size: int = 2):
    text = "\n".join(_DEFAULT_CORPUS)
    return markovify.Text(text, state_size=state_size) if markovify else None


def generate_coherent_text(target_length: int = 200, state_size: int = 2) -> Tuple[str, int]:
    """
    随机生成一段具有上下文连续性的文本。
    若安装了 markovify 则使用马尔可夫链生成；否则退化为简单拼接默认段落。

    参数:
      target_length: 目标字符数（大约值，最终结果可能略有偏差）。
      state_size: 马尔可夫模型的状态长度，影响句子连贯程度。

    返回:
      (text, actual_length): 文本内容及实际字符数。
    """
    if target_length <= 0:
        return "", 0

    if markovify:
        model = _build_default_model(state_size)
        sentences = []
        current_length = 0
        while current_length < target_length:
            sentence = model.make_sentence() or random.choice(_DEFAULT_CORPUS)
            sentences.append(sentence)
            current_length += len(sentence)
        text = " ".join(sentences)
    else:
        random.shuffle(_DEFAULT_CORPUS)
        text = " ".join(_DEFAULT_CORPUS)
        while len(text) < target_length:
            text += " " + random.choice(_DEFAULT_CORPUS)

    text = text[:target_length] if len(text) > target_length + 50 else text
    return text, len(text)


if __name__ == "__main__":
    sample_text, length = generate_coherent_text(target_length=180, state_size=3)
    print(f"Generated text length: {length}")
    print(sample_text)
